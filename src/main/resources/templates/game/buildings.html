<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Здание</title>
    <link th:href="@{/webjars/bootstrap/3.3.6/css/bootstrap.min.css}" rel="stylesheet"></link>
    <link th:href="@{/css/common.css}" rel="stylesheet"></link>
</head>
<body style="padding-top: 100px;">
<div th:replace="fragments/navigation :: nav-for-game"></div>
<div class="container">
    <th:block th:if="${family.getLevel() == 0}">
        <div class="alert alert-success">
            На этой вкладке будут отображены здания в городе, которыми вы владеете. Ну, пока здесь пусто... <br/>
        </div>
    </th:block>
    <div class="well">
        <h3>Ваши здания:</h3>
        <ul class="list-inline">
            <!--/*@thymesVar id="buildingList" type="List<dyn.model.House>"*/-->
            <li th:each="building : ${buildingList}">
                <a th:href="${'/game/buildings#building'+building.getId()}" th:text="${building.getName()}">Home</a>
            </li>
        </ul>
    </div>
    <th:block th:if="${#lists.size(buildingList) > 0}">
        <th:block th:each="mapEntry : ${buildingMap}" th:with="building = ${mapEntry.getKey()}, roomViewList = ${mapEntry.getValue()}">
            <a th:name="${'building'+building.getId()}" class="anchor"></a>
            <h3 th:text="${#strings.toUpperCase(building.getName())}">Здание</h3>
            <th:block th:with="roomView = ${roomViewList.get(0)}">
                <!--/*@thymesVar id="roomView" type="dyn.model.RoomView"*/-->
                <th:block th:if="${roomView.isFull()}" th:with="production = ${building.getProduction()}">
                    <!--/*@thymesVar id="production" type="dyn.model.Project"*/-->
                    <p th:text="${production.getName()}"></p>
                    <th:block th:if="${production ne null}">

                        <form th:action="@{/game/makeItem}" method="post">
                            <label>
                                <th:block th:text="${production.getName() + ' (' + production.getCost() + ' р.'+ (production.resString()!=''?', '+production.resString():'')+')'}"></th:block>
                            </label>
                            <input type="hidden" name="projectId" th:value="${production.getId()}"/>
                            <button id="makeItemButton" type="submit" class="btn btn-default btn-md" th:disabled="${not family.hasResourcesForProject(production)}">Изготовить предмет</button>
                        </form>

                    </th:block>

                </th:block>
                <div th:replace="fragments/roomView :: room-view (roomView=${roomView})"></div>
            </th:block>


        </th:block>

    </th:block>
    <!--/*@thymesVar id="family" type="dyn.model.Family"*/-->
    <!--/*@thymesVar id="building" type="dyn.model.buildings.Building"*/-->
    <!--/*@thymesVar id="buildingMap" type="Map<Building, List<BuildingThingWithItems>>"*/-->
</div>
<th:block th:replace="fragments/scripts :: webjars"></th:block>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
</body>
</html>